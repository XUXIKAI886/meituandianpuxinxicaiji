# 店铺信息提取器 - 使用说明

## 快速开始

### 方法一：使用启动脚本（推荐）
1. 双击运行 `start.bat` 文件
2. 脚本会自动检查并安装所需依赖
3. 应用启动后即可使用

### 方法二：手动启动
1. 确保已安装 Node.js 和 Python
2. 安装依赖：
   ```bash
   npm install
   pip install pandas openpyxl
   ```
3. 启动应用：
   ```bash
   npm start
   ```

## 功能使用指南

### 1. 基本数据提取

#### 步骤：
1. **选择数据源文件**
   - 点击"浏览"按钮
   - 选择包含店铺信息的文本文件（支持JSON格式）
   - 当前示例文件：`dianpuxinxi.txt`

2. **设置输出文件**
   - 点击"选择保存位置"按钮
   - 选择Excel文件保存路径
   - 建议文件名：`店铺数据.xlsx`

3. **执行提取**
   - 点击"开始提取"按钮
   - 等待处理完成
   - 查看提取结果

#### 选项说明：
- **追加模式**：勾选后新数据会追加到现有Excel文件，不会覆盖原有数据

### 2. 实时监控功能

#### 启用监控：
1. 完成基本设置（数据源文件和输出文件）
2. 点击"开启监控"按钮
3. 系统开始监控数据源文件变化

#### 监控工作原理：
- 当数据源文件发生变化时，系统自动检测
- 自动提取新增的店铺信息
- 自动追加到Excel文件（不覆盖现有数据）
- 在界面上显示更新通知

#### 停止监控：
- 点击"停止监控"按钮即可停止文件监控

### 3. 界面功能说明

#### 状态信息区域：
- **当前状态**：显示应用当前操作状态
- **监控状态**：显示文件监控是否启用
- **最后更新**：显示最近一次数据更新时间

#### 提取结果区域：
- 显示已提取的店铺信息概览
- 包含店铺名称、电话、地址等关键信息
- 支持清空结果功能

#### 操作日志区域：
- 记录所有操作的详细日志
- 不同类型的消息用不同颜色标识：
  - 蓝色：信息日志
  - 绿色：成功操作
  - 橙色：警告信息
  - 红色：错误信息

## 数据格式要求

### 支持的文件格式：
- JSON格式的文本文件
- 单行JSON或多行JSON

### JSON数据结构示例：
```json
{
  "msg": "成功",
  "code": 0,
  "data": {
    "id": -100,
    "name": "店铺名称",
    "call_center": "联系电话",
    "address": "详细地址",
    "shipping_time": "营业时间",
    "shipping_fee": 配送费,
    "min_price": 起送价,
    "wm_poi_score": 评分,
    "avg_delivery_time": 配送时间,
    "comment_num": 评论数
  }
}
```

### 提取的字段：
- 店铺ID、店铺名称、联系电话
- 店铺地址、营业时间
- 配送费、起送价、店铺评分
- 平均配送时间、评论数量
- 经纬度、距离信息
- 优惠信息等

## 常见问题解决

### 1. 应用无法启动
**可能原因：**
- Node.js 未安装或版本过低
- Python 未安装或版本过低

**解决方法：**
- 安装 Node.js 16+ 版本
- 安装 Python 3.7+ 版本
- 确保已添加到系统PATH

### 2. 依赖安装失败
**可能原因：**
- 网络连接问题
- 权限不足

**解决方法：**
```bash
# 使用管理员权限运行命令行
# 或使用国内镜像源
npm install --registry https://registry.npmmirror.com
pip install pandas openpyxl -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 3. 数据提取失败
**可能原因：**
- 文件格式不正确
- JSON格式错误
- 文件编码问题

**解决方法：**
- 确保文件为UTF-8编码
- 验证JSON格式是否正确
- 检查文件是否包含有效的店铺数据

### 4. Excel文件无法保存
**可能原因：**
- 目标文件被其他程序占用
- 磁盘空间不足
- 权限不足

**解决方法：**
- 关闭Excel等可能占用文件的程序
- 检查磁盘空间
- 选择有写入权限的目录

### 5. 文件监控不工作
**可能原因：**
- 文件路径错误
- 权限不足
- 文件被锁定

**解决方法：**
- 确认文件路径正确
- 确保对文件有读取权限
- 重新选择文件并启动监控

## 技术支持

### 日志查看：
- 应用内置详细日志系统
- 查看"操作日志"区域了解详细信息
- 根据日志信息定位问题

### 数据备份：
- 建议定期备份Excel输出文件
- 重要数据建议多地备份

### 性能优化：
- 大量数据处理时建议分批进行
- 监控功能会占用一定系统资源
- 不使用时建议停止监控

## 更新日志

### v1.0.0 (当前版本)
- ✅ 基础数据提取功能
- ✅ Excel导出功能
- ✅ 实时文件监控
- ✅ 现代化用户界面
- ✅ 详细日志系统
- ✅ 追加模式支持

### 计划功能：
- 📋 支持更多数据格式
- 📋 批量文件处理
- 📋 数据过滤和筛选
- 📋 自定义字段映射
- 📋 数据统计和分析
